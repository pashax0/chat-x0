{"version":3,"sources":["components/Messages.js"],"names":["Messages","props","_this","Object","d_study_rsschool2019q1_chat_x0_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__","this","d_study_rsschool2019q1_chat_x0_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__","d_study_rsschool2019q1_chat_x0_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__","call","state","showLoader","isActiveWindow","listRef","React","createRef","_this2","window","addEventListener","setState","prevProps","msgs","refs","list","scrollTop","Notification","permission","length","notifText","message","body","react__WEBPACK_IMPORTED_MODULE_5___default","a","createElement","className","ref","map","msg","key","id","from","Date","time","toLocaleString","Component"],"mappings":"4KAIMA,qBACJ,SAAAA,EAAYC,GAAO,IAAAC,EAAA,OAAAC,OAAAC,EAAA,EAAAD,CAAAE,KAAAL,IACjBE,EAAAC,OAAAG,EAAA,EAAAH,CAAAE,KAAAF,OAAAI,EAAA,EAAAJ,CAAAH,GAAAQ,KAAAH,KAAMJ,KACDQ,MAAQ,CACXC,YAAY,EACZC,gBAAgB,GAElBT,EAAKU,QAAUC,IAAMC,YANJZ,mFAkBC,IAAAa,EAAAV,KAClBW,OAAOC,iBAAiB,QAAS,kBAC/BF,EAAKG,SAAS,CACZP,gBAAgB,MAGpBK,OAAOC,iBAAiB,OAAQ,kBAC9BF,EAAKG,SAAS,CACZP,gBAAgB,iDAUHQ,GAAW,IACpBC,EAASf,KAAKJ,MAAdmB,KACSf,KAAKgB,KAAKC,KACLjB,KAAKJ,MAAnBsB,UACR,GAAgC,YAA5BC,aAAaC,YACZN,EAAUC,KAAKM,SAAWN,EAAKM,SAC9BrB,KAAKI,MAAME,eAAgB,CAC/B,IAAMgB,EAAYP,EAAKA,EAAKM,OAAS,GAAGE,QACxC,IAAIJ,aAAa,UAAU,CAACK,KAAMF,sCAK7B,IACCP,EAASf,KAAKJ,MAAdmB,KAEN,OACEU,EAAAC,EAAAC,cAAA,MACEC,UAAU,WACVC,IAAI,QAGHd,EAAKe,IAAI,SAAAC,GAAG,OACXN,EAAAC,EAAAC,cAAA,MACEC,UAAU,gBACVI,IAAKD,EAAIE,IAETR,EAAAC,EAAAC,cAAA,OAAKC,UAAU,YACbH,EAAAC,EAAAC,cAAA,OACEC,UAAU,cACVG,EAAIG,MACNT,EAAAC,EAAAC,cAAA,OACEC,UAAU,YACT,IAAIO,KAAKJ,EAAIK,MAAOC,mBAEzBZ,EAAAC,EAAAC,cAAA,OAAKC,UAAU,YACbG,EAAIR,oBAzEGe,cAkFR3C","file":"static/js/3.3f80bc56.chunk.js","sourcesContent":["import React, {Component} from 'react';\n\nimport '../styles/messages.scss';\n\nclass Messages extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      showLoader: false,\n      isActiveWindow: true,\n    }\n    this.listRef = React.createRef();\n  }\n\n  // getSnapshotBeforeUpdate(prevProps, prevState) {\n  //   // Добавляются ли в список новые элементы?\n  //   // Запоминаем значение прокрутки, чтобы использовать его позже.\n  //   if (prevProps.list.length < this.props.list.length) {\n  //     const list = this.listRef.current;\n  //     return list.scrollHeight - list.scrollTop;\n  //   }\n  //   return null;\n  // }\n  componentDidMount() {\n    window.addEventListener(\"focus\", () => (\n      this.setState({\n        isActiveWindow: true,\n      })\n    ))\n    window.addEventListener(\"blur\", () => (\n      this.setState({\n        isActiveWindow: false,\n      })\n    ))\n    // setTimeout(() => {\n    //   if(this.loading){\n    //     this.setState({ showLoader: true })\n    //   }\n    // }, 5000);\n  }\n\n  componentDidUpdate(prevProps) {\n    const { msgs } = this.props;\n    const msgsList = this.refs.list;\n    const { scrollTop } = this.props;\n    if (Notification.permission === 'granted'\n      && prevProps.msgs.length !== msgs.length\n      && !this.state.isActiveWindow) {\n      const notifText = msgs[msgs.length - 1].message;\n      new Notification('Chat-x0',{body: notifText});\n      // msgsList.scrollTo(0, scrollTop);\n    }\n  }\n\n  render() {\n    const { msgs } = this.props;\n    // if(this.state.showLoader) {\n      return (\n        <ul\n          className=\"messages\"\n          ref=\"list\"\n          // onScroll={(ev) => this.props.scrolling(ev)}\n        >\n          {msgs.map(msg =>\n            <li\n              className=\"msg-container\"\n              key={msg.id}\n            >\n              <div className=\"msg-info\">\n                <div\n                  className=\"msg-author\"\n                >{msg.from}</div>\n                <div\n                  className=\"msg-date\"\n                >{(new Date(msg.time)).toLocaleString()}</div>\n              </div>\n              <div className=\"msg-text\"\n              >{msg.message}</div>\n            </li>\n          )}\n        </ul>\n      )\n    // }\n  }\n}\n\nexport default Messages;\n"],"sourceRoot":""}