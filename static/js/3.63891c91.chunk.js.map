{"version":3,"sources":["components/Messages.js"],"names":["Messages","props","_this","Object","d_study_rsschool2019q1_chat_x0_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__","this","d_study_rsschool2019q1_chat_x0_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__","d_study_rsschool2019q1_chat_x0_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__","call","state","showLoader","isActiveWindow","listRef","React","createRef","console","log","msgsList","refs","list","scrollTop","scrollTo","scrollHeight","prevProps","msgs","Notification","permission","length","notifText","message","body","_this$props","from","react__WEBPACK_IMPORTED_MODULE_5___default","a","createElement","className","ref","map","msg","concat","key","id","Date","time","toLocaleString","Component"],"mappings":"4KAIMA,qBACJ,SAAAA,EAAYC,GAAO,IAAAC,EAAA,OAAAC,OAAAC,EAAA,EAAAD,CAAAE,KAAAL,IACjBE,EAAAC,OAAAG,EAAA,EAAAH,CAAAE,KAAAF,OAAAI,EAAA,EAAAJ,CAAAH,GAAAQ,KAAAH,KAAMJ,KACDQ,MAAQ,CACXC,YAAY,EACZC,gBAAgB,GAGlBT,EAAKU,QAAUC,IAAMC,YAPJZ,mFAoBjBa,QAAQC,IAAI,kBACZ,IAAMC,EAAWZ,KAAKa,KAAKC,KACLd,KAAKJ,MAAnBmB,UACRH,EAASI,SAAS,EAAGJ,EAASK,yDAGbC,GAAW,IACpBC,EAASnB,KAAKJ,MAAduB,KACR,GAAgC,YAA5BC,aAAaC,YACZH,EAAUC,KAAKG,SAAWH,EAAKG,SAC9BtB,KAAKI,MAAME,eAAgB,CAC/B,IAAMiB,EAAYJ,EAAKA,EAAKG,OAAS,GAAGE,QACxC,IAAIJ,aAAa,UAAU,CAACK,KAAMF,sCAI7B,IAAAG,EAEgB1B,KAAKJ,MAApBuB,EAFDO,EAECP,KAAMQ,EAFPD,EAEOC,KAEZ,OACEC,EAAAC,EAAAC,cAAA,MACEC,UAAU,WACVC,IAAI,QAGHb,EAAKc,IAAI,SAAAC,GAAG,OACXN,EAAAC,EAAAC,cAAA,MACEC,UAAS,iBAAAI,OAAmBR,IAASO,EAAIP,KAAO,MAAQ,IACxDS,IAAKF,EAAIG,IAETT,EAAAC,EAAAC,cAAA,OAAKC,UAAU,YACbH,EAAAC,EAAAC,cAAA,OACEC,UAAU,cACVG,EAAIP,MACNC,EAAAC,EAAAC,cAAA,OACEC,UAAU,YACT,IAAIO,KAAKJ,EAAIK,MAAOC,mBAEzBZ,EAAAC,EAAAC,cAAA,KAAGC,UAAU,YACXG,EAAIV,oBA7DGiB,cAsER9C","file":"static/js/3.63891c91.chunk.js","sourcesContent":["import React, {Component} from 'react';\r\n\r\nimport '../styles/messages.scss';\r\n\r\nclass Messages extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      showLoader: false,\r\n      isActiveWindow: true,\r\n      // msgs: [],\r\n    }\r\n    this.listRef = React.createRef();\r\n  }\r\n\r\n  // getSnapshotBeforeUpdate(prevProps, prevState) {\r\n  //   // Добавляются ли в список новые элементы?\r\n  //   // Запоминаем значение прокрутки, чтобы использовать его позже.\r\n  //   if (prevProps.list.length < this.props.list.length) {\r\n  //     const list = this.listRef.current;\r\n  //     return list.scrollHeight - list.scrollTop;\r\n  //   }\r\n  //   return null;\r\n  // }\r\n  componentDidMount() {\r\n    console.log('message update');\r\n    const msgsList = this.refs.list;\r\n    const { scrollTop } = this.props;\r\n    msgsList.scrollTo(0, msgsList.scrollHeight);\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    const { msgs } = this.props;\r\n    if (Notification.permission === 'granted'\r\n      && prevProps.msgs.length !== msgs.length\r\n      && !this.state.isActiveWindow) {\r\n      const notifText = msgs[msgs.length - 1].message;\r\n      new Notification('Chat-x0',{body: notifText});\r\n    }\r\n  }\r\n\r\n  render() {\r\n    // const { msgs } = this.state;\r\n    const { msgs, from } = this.props;\r\n    // if(this.state.showLoader) {\r\n      return (\r\n        <ul\r\n          className=\"messages\"\r\n          ref=\"list\"\r\n          // onScroll={(ev) => this.props.scrolling(ev)}\r\n        >\r\n          {msgs.map(msg =>\r\n            <li\r\n              className={`msg-container ${from === msg.from ? 'own' : ''}`}\r\n              key={msg.id}\r\n            >\r\n              <div className=\"msg-info\">\r\n                <div\r\n                  className=\"msg-author\"\r\n                >{msg.from}</div>\r\n                <div\r\n                  className=\"msg-date\"\r\n                >{(new Date(msg.time)).toLocaleString()}</div>\r\n              </div>\r\n              <p className=\"msg-text\"\r\n              >{msg.message}</p>\r\n            </li>\r\n          )}\r\n        </ul>\r\n      )\r\n    // }\r\n  }\r\n}\r\n\r\nexport default Messages;\r\n"],"sourceRoot":""}